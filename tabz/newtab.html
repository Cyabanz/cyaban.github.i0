<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>New Tab</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    body {
      background: var(--nt-bg, #202124);
      color: var(--nt-color, #e8eaed);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      margin: 0;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      transition: background 0.2s, color 0.2s;
    }
    .search-bar {
      margin-top: 60px;
      width: 100%;
      max-width: 480px;
      display: flex;
      border-radius: 24px;
      overflow: hidden;
      border: 1px solid #444;
      background: #303134;
    }
    .search-bar input {
      flex: 1;
      padding: 16px;
      border: none;
      background: transparent;
      color: inherit;
      font-size: 1.2rem;
      outline: none;
    }
    .search-bar button {
      background: #444;
      color: inherit;
      border: none;
      padding: 0 20px;
      cursor: pointer;
      font-size: 1.2rem;
      outline: none;
    }
    .bookmarks {
      margin-top: 32px;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(112px, 1fr));
      gap: 24px;
      width: 100%;
      max-width: 640px;
    }
    .bookmark {
      display: flex;
      flex-direction: column;
      align-items: center;
      background: #28292c;
      border-radius: 12px;
      padding: 18px 8px;
      text-decoration: none;
      transition: background 0.2s;
    }
    .bookmark:hover {
      background: #35363a;
    }
    .bookmark-icon {
      width: 36px;
      height: 36px;
      margin-bottom: 8px;
      border-radius: 8px;
      background: #111;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.7em;
    }
    .bookmark-label {
      text-align: center;
      font-size: 1em;
      color: inherit;
      word-break: break-word;
    }
    #theme-switcher {
      margin-top: 36px;
      display: flex;
      gap: 10px;
    }
    .theme-btn {
      background: #444;
      color: #fff;
      border: none;
      border-radius: 6px;
      padding: 7px 16px;
      font-size: 1em;
      cursor: pointer;
      transition: background 0.2s;
    }
    .theme-btn.active, .theme-btn:hover {
      background: #1a73e8;
      color: #fff;
    }
    .uv-features {
      margin-top: 40px;
      width: 100%;
      max-width: 600px;
      background: #232336;
      border-radius: 14px;
      padding: 18px 22px;
      color: #d8d9fa;
      font-size: 1.07em;
      box-shadow: 0 2px 16px #19193a44;
    }
    .uv-features h3 {
      margin: 0 0 10px 0;
      color: #ffd700;
      font-size: 1.19em;
    }
    .uv-features ul {
      margin: 0 0 0 22px;
      padding: 0;
    }
    .uv-features li {
      margin-bottom: 7px;
      line-height: 1.7;
    }
    @media (max-width: 700px) {
      .bookmarks, .uv-features { max-width: 98vw; }
      .search-bar { max-width: 97vw; }
    }
  </style>
  <!-- Ultraviolet search bar support -->
  <script src="/uv/uv.bundle.js"></script>
  <script src="/uv/uv.config.js"></script>
</head>
<body>
  <form class="search-bar" id="nt-search-form" autocomplete="off">
    <input id="nt-search" type="text" placeholder="Search or type a URL" autofocus>
    <button type="submit">â†’</button>
  </form>
  <div class="bookmarks" id="nt-bookmarks">
    <!-- Bookmarks injected here -->
  </div>
  <div id="theme-switcher">
    <button class="theme-btn" id="nt-theme-dark">Dark</button>
    <button class="theme-btn" id="nt-theme-light">Light</button>
    <button class="theme-btn" id="nt-theme-custom">Custom</button>
  </div>
  <div class="uv-features">
    <h3>Ultraviolet Features</h3>
    <ul>
      <li>Bypass web filters and browse the web privately.</li>
      <li>Supports most modern websites (YouTube, Google, Discord, etc).</li>
      <li>Customizable search engine and easy tab navigation.</li>
      <li>Theme switching between Dark, Light, and Custom modes.</li>
      <li>Bookmarks/shortcuts for quick access to favorite sites.</li>
      <li>Drag-and-drop tabs, ad skipping, and more!</li>
    </ul>
  </div>
  <script>
    // === Bookmarks ===
    const bookmarks = [
      { url: "https://www.google.com", label: "Google", icon: "ðŸ”Ž" },
      { url: "https://www.youtube.com", label: "YouTube", icon: "â–¶ï¸" },
      { url: "https://github.com", label: "GitHub", icon: "ðŸ™" },
      { url: "https://mail.google.com", label: "Gmail", icon: "âœ‰ï¸" },
      { url: "https://chat.openai.com", label: "ChatGPT", icon: "ðŸ’¬" }
    ];
    const bmEl = document.getElementById('nt-bookmarks');
    bookmarks.forEach(bm => {
      const a = document.createElement('a');
      a.className = 'bookmark';
      a.href = "#"; // Prevent default navigation
      a.innerHTML = `<div class="bookmark-icon">${bm.icon}</div>
        <div class="bookmark-label">${bm.label}</div>`;
      a.addEventListener('click', e => {
        e.preventDefault();
        openUvUrl(bm.url);
      });
      bmEl.appendChild(a);
    });

    // === UV Search Bar ===
    function proxifyUrl(url) {
      if (url.startsWith(location.origin + __uv$config.prefix)) return url;
      return __uv$config.prefix + __uv$config.encodeUrl(url);
    }
    function openUvUrl(url) {
      // Handles navigation in UV context (window.parent or self)
      if (window.parent !== window) {
        // Send message to parent (main tab manager) to handle navigation
        window.parent.postMessage({ ntNavigate: url }, '*');
      } else {
        // Standalone mode: navigate this window using UV
        window.location.href = proxifyUrl(url);
      }
    }
    // Listen for parent message for navigation (if in iframe)
    window.addEventListener('message', e => {
      if (e.data.ntSetTheme) setTheme(e.data.ntSetTheme.dark, e.data.ntSetTheme.custom);
      if (e.data.ntNavigate) openUvUrl(e.data.ntNavigate);
    });

    // === Search Bar ===
    const searchEngine = localStorage.getItem('searchEngine') || 'https://www.google.com/search?q=';
    document.getElementById('nt-search-form').addEventListener('submit', e => {
      e.preventDefault();
      let q = document.getElementById('nt-search').value.trim();
      if (!q) return;
      if (!q.includes('://')) {
        if (q.includes('.')) q = 'https://' + q;
        else q = searchEngine + encodeURIComponent(q);
      }
      openUvUrl(q);
    });

    // === Theme Switcher ===
    function setTheme(dark, custom) {
      if (custom) {
        document.body.style.setProperty('--nt-bg', custom.bg || '#202124');
        document.body.style.setProperty('--nt-color', custom.color || '#e8eaed');
      } else if (dark) {
        document.body.style.setProperty('--nt-bg', '#202124');
        document.body.style.setProperty('--nt-color', '#e8eaed');
      } else {
        document.body.style.setProperty('--nt-bg', '#f8f9fa');
        document.body.style.setProperty('--nt-color', '#1a1a1a');
      }
    }
    function applyThemeBtn(which) {
      document.querySelectorAll('.theme-btn').forEach(btn => btn.classList.remove('active'));
      if (which === 'dark') document.getElementById('nt-theme-dark').classList.add('active');
      if (which === 'light') document.getElementById('nt-theme-light').classList.add('active');
      if (which === 'custom') document.getElementById('nt-theme-custom').classList.add('active');
    }
    document.getElementById('nt-theme-dark').onclick = () => {
      parent.postMessage({ ntThemeSelected: 'dark' }, '*');
      setTheme(true);
      applyThemeBtn('dark');
    };
    document.getElementById('nt-theme-light').onclick = () => {
      parent.postMessage({ ntThemeSelected: 'light' }, '*');
      setTheme(false);
      applyThemeBtn('light');
    };
    document.getElementById('nt-theme-custom').onclick = () => {
      parent.postMessage({ ntThemeSelected: 'custom' }, '*');
      // Example custom theme, expand as needed
      setTheme(false, { bg: '#2e2f50', color: '#ffd700' });
      applyThemeBtn('custom');
    };
    // Default to dark
    setTheme(true);
    applyThemeBtn('dark');
  </script>
</body>
</html>
